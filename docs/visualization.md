# Visualization & Data Capture Guide

This workflow shows how to monitor the whole-body stack, record a run, and generate plots.

## Prerequisites
- Build the workspace: `colcon build`
- Source the overlay: `. install/setup.bash`

## Launch with RViz and Recording
```bash
ros2 launch mobile_arm_whole_body_bringup whole_body_streaming.launch.py
```
This launch file:
- Starts MoveIt, planners, supervisor, and base commander
- Launches RViz with `rviz/whole_body_monitor.rviz`
- Publishes the synthetic disc obstacles via `obstacle_manager_node`
- Records a rosbag (`whole_body_demo`) capturing
  `/whole_body/arm_plan`, `/whole_body/base_plan`, `/whole_body/state`, `/whole_body/cmd_vel`, `/whole_body/obstacle_grid`

## Converting Rosbag Topics to CSV
After stopping the launch, convert the recorded topics:
```bash
ros2 bag play whole_body_demo --loop &  # optional background replay
ros2 bag record ...                     # already generated by launch
# Extract CSVs using ros2 bag or custom tools (e.g., ros2 bag convert)
```
(Use your preferred method to export bag topics to CSV; ensure they map to `--state`, `--cmd`, etc. for the plotting script.)

## Plotting Diagnostics
```bash
python tools/plot_whole_body_log.py \
  --state analysis/results/state.csv \
  --cmd analysis/results/cmd.csv \
  --base-plan analysis/results/base_plan.csv \
  --obstacle-grid analysis/results/obstacles.csv \
  --save
```
This generates summary plots in `analysis/results/` showing stage transitions, base velocity commands, and the XY layout of obstacles versus the planned path. Use `--output` to specify a custom file name or omit `--save` to view interactively.
